<?php
//This file displays the form.tpl to the user, and then once the user has filled out the form, validates the information the user entered. If the information is validated, the information is imported into the database. If the information is not validated, the user is returned to the form, with their information still filled out, but with each of the errors written in red at the top of the form so they can correct it. This program also sanitizes (renders harmless any harmful characters or commands) that a user might enter into a field.

ini_set('display_errors', 'On');

error_reporting(-1);

//includes the config file and necessary files for smarty to run.
include('/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/config.php');
include('/home1/columch7/public_html/smarty-3.1.27/libs/Smarty.class.php');

//Creates a smarty object and designates associated folders. 
$smarty = new Smarty;

$smarty->template_dir = '/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/templates/';
$smarty->compile_dir  = '/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/templates_c/';
$smarty->config_dir   = '/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/configs/';
$smarty->cache_dir    = '/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/cache/';

$validating_regex = array(
	"FIRST_NAME" => "/(^[a-zA-Z ]+$)/",
	"LAST_NAME" => "/(^[a-zA-Z ]+$)/",	
	"PHONE_1" => "/(^\d{3}$)/",
	"PHONE_2" => "/(^\d{3}$)/",
	"PHONE_3" => "/(^\d{4}$)/",
	"EMAIL" => "/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/",
	"ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"STATE" => "/^[A-Z]{2}$/",
	"ZIP" => "/(^\d{5}$)/",
	"DOB_1" => "/(\d{1,2})/",
	"DOB_2" => "/(\d{1,2})/",
	"DOB_3" => "/(\d{4})/",
	"SSN" => "/\d{9}/",
	"EMPLOYER_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"EMPLOYER_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"EMPLOYER_STATE" => "/^[A-Z]{2}$/",
	"EMPLOYER_ZIP" => "/(^\d{5}$)/",
	"PHYSICIAN_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"PHYSICIAN_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"PHYSICIAN_STATE" => "/^[A-Z]{2}$/",
	"PHYSICIAN_ZIP" => "/(^\d{5}$)/",
	"PHYSICIAN_PHONE_1" => "/(^\d{3}$)/",
	"PHYSICIAN_PHONE_2" => "/(^\d{3}$)/",
	"PHYSICIAN_PHONE_3" => "/(^\d{4}$)/",
	"SPOUSE_FIRST" => "/(^[a-zA-Z ]+$)/",
	"SPOUSE_LAST" => "/(^[a-zA-Z ]+$)/",
	"SPOUSE_HOME_PHONE_1" => "/(^\d{3}$)/",
	"SPOUSE_HOME_PHONE_2" => "/(^\d{3}$)/",
	"SPOUSE_HOME_PHONE_3" => "/(^\d{4}$)/",
	"SPOUSE_WORK_PHONE_1" => "/(^\d{3}$)/",
	"SPOUSE_WORK_PHONE_2" => "/(^\d{3}$)/",
	"SPOUSE_WORK_PHONE_3" => "/(^\d{4}$)/",
	"SPOUSE_SSN" => "/\d{9}/",
	"MOTHER_FIRST" => "/(^[a-zA-Z ]+$)/",
	"MOTHER_LAST" => "/(^[a-zA-Z ]+$)/",
	"MOTHER_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"MOTHER_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"MOTHER_STATE" => "/^[A-Z]{2}$/",
	"MOTHER_ZIP" => "/(^\d{5}$)/",
	"MOTHER_SSN" => "/\d{9}/",
	"MOTHER_EMPLOYER_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"MOTHER_EMPLOYER_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"MOTHER_EMPLOYER_STATE" => "/^[A-Z]{2}$/",
	"MOTHER_EMPLOYER_ZIP" => "/(^\d{5}$)/",
	"MOTHER_EMPLOYER_PHONE_1" => "/(^\d{3}$)/",
	"MOTHER_EMPLOYER_PHONE_2" => "/(^\d{3}$)/",
	"MOTHER_EMPLOYER_PHONE_3" => "/(^\d{4}$)/",
	"FATHER_FIRST" => "/(^[a-zA-Z ]+$)/",
	"FATHER_LAST" => "/(^[a-zA-Z ]+$)/",
	"FATHER_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"FATHER_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"FATHER_STATE" => "/^[A-Z]{2}$/",
	"FATHER_ZIP" => "/(^\d{5}$)/",
	"FATHER_SSN" => "/\d{9}/",
	"FATHER_EMPLOYER_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"FATHER_EMPLOYER_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"FATHER_EMPLOYER_STATE" => "/^[A-Z]{2}$/",
	"FATHER_EMPLOYER_ZIP" => "/(^\d{5}$)/",
	"FATHER_EMPLOYER_PHONE_1" => "/(^\d{3}$)/",
	"FATHER_EMPLOYER_PHONE_2" => "/(^\d{3}$)/",
	"FATHER_EMPLOYER_PHONE_3" => "/(^\d{4}$)/",
	"PRIMARY_INSURANCE_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"PRIMARY_INSURANCE_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"PRIMARY_INSURANCE_STATE" => "/^[A-Z]{2}$/",
	"PRIMARY_INSURANCE_ZIP" => "/(^\d{5}$)/",
	"PI_SUBSCRIBER_FIRST" => "/(^[a-zA-Z ]+$)/",
	"PI_SUBSCRIBER_LAST" => "/(^[a-zA-Z ]+$)/",
	"PI_SUBSCRIBER_ID" => "/([a-zA-Z0-9-]+)/",
	"PI_SUBSCRIBER_GROUP_NUMBER" => "/([a-zA-Z0-9-]+)/",
	"PI_SUBSCRIBER_DOB_1" => "/(\d{1,2})/",
	"PI_SUBSCRIBER_DOB_2" => "/(\d{1,2})/",
	"PI_SUBSCRIBER_DOB_3" => "/(\d{4})/",
	"SECONDARY_INSURANCE_ADDRESS_1" => "/(\d{1,7}\s\w{0,2}(\.)\s(\b\w*\b\s){1,3}\w*\.)/",
	"SECONDARY_INSURANCE_CITY" => "/(^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$)/",
	"SECONDARY_INSURANCE_STATE" => "/^[A-Z]{2}$/",
	"SECONDARY_INSURANCE_ZIP" => "/(^\d{5}$)/",
	"SI_SUBSCRIBER_FIRST" => "/(^[a-zA-Z ]+$)/",
	"SI_SUBSCRIBER_LAST" => "/(^[a-zA-Z ]+$)/",
	"SI_SUBSCRIBER_ID" => "/([a-zA-Z0-9-]+)/",
	"SI_SUBSCRIBER_GROUP_NUMBER" => "/([a-zA-Z0-9-]+)/",
	"SI_SUBSCRIBER_DOB_1" => "/(\d{1,2})/",
	"SI_SUBSCRIBER_DOB_2" => "/(\d{1,2})/",
	"SI_SUBSCRIBER_DOB_3" => "/(\d{4})/",
	"DATE_OF_INJURY_1" => "/(\d{1,2})/",
	"DATE_OF_INJURY_2" => "/(\d{1,2})/",
	"DATE_OF_INJURY_3" => "/(\d{4})/",
	"CLAIM_NUMBER" => "/([a-zA-z0-9]{6,8})/",
	"EMERGENCY_CONTACT_FIRST" => "/(^[a-zA-Z ]+$)/",
	"EMERGENCY_CONTACT_LAST" => "/(^[a-zA-Z ]+$)/",
	"EMERGENCY_CONTACT_PHONE_1" => "/(^\d{3}$)/",
	"EMERGENCY_CONTACT_PHONE_2" => "/(^\d{3}$)/",
	"EMERGENCY_CONTACT_PHONE_3" => "/(^\d{4}$)/",
);

$error_dictionary = array(
	"FIRST_NAME" => "Please make sure that the first name has only letters and spaces.",
	"LAST_NAME" => "Please make sure that the last name has only letters and spaces.",	
	"PHONE_1" => "Please make sure the there are 3 digits in the first section of the phone number.",
	"PHONE_2" => "Please make sure the there are 3 digits in the second section of the phone number.",
	"PHONE_3" => "Please make sure the there are 4 digits in the third section of the phone number.",
	"EMAIL" => "Please enter a valid email address.",
	"ADDRESS_1" => "Please enter a valid address.",
	"CITY" => "Please enter a valid city name.",
	"STATE" => "Please enter a valid state.",
	"ZIP" => "Please make sure the there are 5 digits in the zip code.",
	"DOB_1" => "Please Enter a valid date of birth.",
	"DOB_2" => "Please Enter a valid date of birth.",
	"DOB_3" => "Please Enter a valid date of birth.",
	"SSN" => "Please make sure there are 9 digits in your SSN.",
	"EMPLOYER_ADDRESS_1" => "Please enter a valid employer address.",
	"EMPLOYER_CITY" => "Please enter a valid employer city name.",
	"EMPLOYER_STATE" => "Please enter a valid employer state.",
	"EMPLOYER_ZIP" => "Please make sure there are 5 digits in the employer zip code.",
	"PHYSICIAN_ADDRESS_1" => "Please enter a valid physician address.",
	"PHYSICIAN_CITY" => "Please enter a valid physician city name.",
	"PHYSICIAN_STATE" => "Please enter a valid physician state.",
	"PHYSICIAN_ZIP" => "Please make sure there are 5 digits in the physician zip code.",
	"PHYSICIAN_PHONE_1" => "Please make sure the there are 3 digits in the first section of your physician's phone number.",
	"PHYSICIAN_PHONE_2" => "Please make sure the there are 3 digits in the second section of your physician's phone number.",
	"PHYSICIAN_PHONE_3" => "Please make sure the there are 4 digits in the third section of your physician's phone number.",
	"SPOUSE_FIRST" => "Please make sure that the spouse first name has only letters and spaces.",
	"SPOUSE_LAST" => "Please make sure that the spouse last name has only letters and spaces.",	
	"SPOUSE_HOME_PHONE_1" => "Please make sure the there are 3 digits in the first section of your spouse's home phone number.",
	"SPOUSE_HOME_PHONE_2" => "Please make sure the there are 3 digits in the second section of your spouse's home phone number.",
	"SPOUSE_HOME_PHONE_3" => "Please make sure the there are 4 digits in the third section of your spouse's home phone number.",
	"SPOUSE_WORK_PHONE_1" => "Please make sure the there are 3 digits in the first section of your spouse's work phone number.",
	"SPOUSE_WORK_PHONE_2" => "Please make sure the there are 3 digits in the second section of your spouse's work phone number.",
	"SPOUSE_WORK_PHONE_3" => "Please make sure the there are 4 digits in the third section of your spouse's work phone number.",
	"SPOUSE_SSN" => "Please make sure there are 9 digits in your spouse's SSN.",
	"MOTHER_FIRST" => "Please make sure that the mother's first name has only letters and spaces.",
	"MOTHER_LAST" => "Please make sure that the mother's last name has only letters and spaces.",
	"MOTHER_ADDRESS_1" => "Please enter a valid Mother's address.",
	"MOTHER_CITY" => "Please enter a valid Mother city name.",
	"MOTHER_STATE" => "Please enter a valid Mother state.",
	"MOTHER_ZIP" => "Please make sure there are 5 digits in the Mother zip code.",
	"MOTHER_SSN" => "Please make sure there are 9 digits in the mother's SSN.",
	"MOTHER_EMPLOYER_ADDRESS_1" => "Please enter a valid mother's employer address.",
	"MOTHER_EMPLOYER_CITY" => "Please enter a valid mother's employer city name.",
	"MOTHER_EMPLOYER_STATE" => "Please enter a valid mother's employer state.",
	"MOTHER_EMPLOYER_ZIP" => "Please make sure there are 5 digits in the mother's employer zip code.",
	"MOTHER_EMPLOYER_PHONE_1" => "Please make sure the there are 3 digits in the first section of your mother's employer's phone number.",
	"MOTHER_EMPLOYER_PHONE_2" => "Please make sure the there are 3 digits in the second section of your mother's employer's phone number.",
	"MOTHER_EMPLOYER_PHONE_3" => "Please make sure the there are 4 digits in the third section of your mother's employer's phone number.",
	"FATHER_FIRST" => "Please make sure that the father's first name has only letters and spaces.",
	"FATHER_LAST" => "Please make sure that the father's last name has only letters and spaces.",
	"FATHER_ADDRESS_1" => "Please enter a valid father's address.",
	"FATHER_CITY" => "Please enter a valid father city name.",
	"FATHER_STATE" => "Please enter a valid father state.",
	"FATHER_ZIP" => "Please make sure there are 5 digits in the father's zip code.",
	"FATHER_SSN" => "Please make sure there are 9 digits in the father's SSN.",
	"FATHER_EMPLOYER_ADDRESS_1" => "Please enter a valid father's employer address.",
	"FATHER_EMPLOYER_CITY" => "Please enter a valid father's employer city name.",
	"FATHER_EMPLOYER_STATE" => "Please enter a valid father's employer state.",
	"FATHER_EMPLOYER_ZIP" => "Please make sure there are 5 digits in the father's employer zip code.",
	"FATHER_EMPLOYER_PHONE_1" => "Please make sure the there are 3 digits in the first section of the father's employer's phone number.",
	"FATHER_EMPLOYER_PHONE_2" => "Please make sure the there are 3 digits in the second section of the father's employer's phone number.",
	"FATHER_EMPLOYER_PHONE_3" => "Please make sure the there are 4 digits in the third section of the father's employer's phone number.",
	"PRIMARY_INSURANCE_ADDRESS_1" => "Please enter a valid primary insurance address.",
	"PRIMARY_INSURANCE_CITY" => "Please enter a valid primary insurance city name.",
	"PRIMARY_INSURANCE_STATE" => "Please enter a valid primary insurance state.",
	"PRIMARY_INSURANCE_ZIP" => "Please make sure there are 5 digits in the primary insurance zip code.",
	"PI_SUBSCRIBER_ID" => "Please enter a valid primary insurance subscriber ID.",
	"PI_SUBSCRIBER_GROUP_NUMBER" => "Please enter a vali primary insurance group number.",
	"PI_SUBSCRIBER_DOB_1" => "Please enter a valid date of birth for the primary insurance subscriber.",
	"PI_SUBSCRIBER_DOB_2" => "Please enter a valid date of birth for the primary insurance subscriber.",
	"PI_SUBSCRIBER_DOB_3" => "Please enter a valid date of birth for the primary insurance subscriber.",
	"SECONDARY_INSURANCE_ADDRESS_1" => "Please enter a valid secondary insurance address.",
	"SECONDARY_INSURANCE_CITY" => "Please enter a valid secondary insurance city name.",
	"SECONDARY_INSURANCE_STATE" => "Please enter a valid secondary insurance state.",
	"SECONDARY_INSURANCE_ZIP" => "Please make sure there are 5 digits in the secondary insurance zip code.",
	"SI_SUBSCRIBER_ID" => "Please enter a valid secondary insurance subscriber ID.",
	"SI_SUBSCRIBER_GROUP_NUMBER" => "Please enter a vali secondary insurance group number.",
	"SI_SUBSCRIBER_DOB_1" => "Please enter a valid date of birth for the secondary insurance subscriber.",
	"SI_SUBSCRIBER_DOB_2" => "Please enter a valid date of birth for the secondary insurance subscriber.",
	"SI_SUBSCRIBER_DOB_3" => "Please enter a valid date of birth for the secondary insurance subscriber.",
	"DATE_OF_INJURY_1" => "Please enter a valid date of injury.",
	"DATE_OF_INJURY_2" => "Please enter a valid date of injury.",
	"DATE_OF_INJURY_3" => "Please enter a valid date of injury.",
	"CLAIM_NUMBER" => "Please enter a valid claim number.",
	"EMERGENCY_CONTACT_FIRST" => "Please make sure that the emergency contact's first name has only letters and spaces.",
	"EMERGENCY_CONTACT_LAST" => "Please make sure that the emergency contact's last name has only letters and spaces.",
	"EMERGENCY_CONTACT_PHONE_1" => "Please make sure the there are 3 digits in the first section of the emergency contact's phone number.",
	"EMERGENCY_CONTACT_PHONE_2" => "Please make sure the there are 3 digits in the second section of the emergency contact's phone number.",
	"EMERGENCY_CONTACT_PHONE_3" => "Please make sure the there are 4 digits in the third section of the emergency contact's phone number.",
);

$left_blank = array(
	"SOURCE" => 0,
	"EMPLOYER_ADDRESS_1" => 0,
	"EMPLOYER_CITY" => 0,
	"EMPLOYER_STATE" => 0,
	"EMPLOYER_ZIP" => 0,
	"PHYSICIAN_ADDRESS_1" => 0,
	"PHYSICIAN_CITY" => 0,
	"PHYSICIAN_STATE" => 0,
	"PHYSICIAN_ZIP" => 0,
	"PHYSICIAN_PHONE_1" => 0,
	"PHYSICIAN_PHONE_2" => 0,
	"PHYSICIAN_PHONE_3" => 0,
	"SPOUSE_FIRST" => 0,
	"SPOUSE_LAST" => 0,
	"SPOUSE_HOME_PHONE_1" => 0,
	"SPOUSE_HOME_PHONE_2" => 0,
	"SPOUSE_HOME_PHONE_3" => 0,
	"SPOUSE_WORK_PHONE_1" => 0,
	"SPOUSE_WORK_PHONE_2" => 0,
	"SPOUSE_WORK_PHONE_3" => 0,
	"SPOUSE_SSN" => 0,
	"MOTHER_FIRST" => 0,
	"MOTHER_LAST" => 0,
	"MOTHER_ADDRESS_1" => 0,
	"MOTHER_CITY" => 0,
	"MOTHER_STATE" => 0,
	"MOTHER_ZIP" => 0,
	"MOTHER_SSN" => 0,
	"MOTHER_EMPLOYER_ADDRESS_1" => 0,
	"MOTHER_EMPLOYER_CITY" => 0,
	"MOTHER_EMPLOYER_STATE" => 0,
	"MOTHER_EMPLOYER_ZIP" => 0,
	"MOTHER_EMPLOYER_PHONE_1" => 0,
	"MOTHER_EMPLOYER_PHONE_2" => 0,
	"MOTHER_EMPLOYER_PHONE_3" => 0,
	"FATHER_FIRST" => 0,
	"FATHER_LAST" => 0,
	"FATHER_ADDRESS_1" => 0,
	"FATHER_CITY" => 0,
	"FATHER_STATE" => 0,
	"FATHER_ZIP" => 0,
	"FATHER_SSN" => 0,
	"FATHER_EMPLOYER_ADDRESS_1" => 0,
	"FATHER_EMPLOYER_CITY" => 0,
	"FATHER_EMPLOYER_STATE" => 0,
	"FATHER_EMPLOYER_ZIP" => 0,
	"FATHER_EMPLOYER_PHONE_1" => 0,
	"FATHER_EMPLOYER_PHONE_2" => 0,
	"FATHER_EMPLOYER_PHONE_3" => 0,
	"SI_SUBSCRIBER_FIRST" => 0,
	"SI_SUBSCRIBER_LAST" => 0,
	"SECONDARY_INSURANCE_CITY" => 0,
	"SECONDARY_INSURANCE_STATE" => 0,
	"SECONDARY_INSURANCE_ZIP" => 0,
	"SI_SUBSCRIBER_ID" => 0,
	"SI_SUBSCRIBER_GROUP_NUMBER" => 0,
	"SI_SUBSCRIBER_DOB_1" => 0,
	"SI_SUBSCRIBER_DOB_2" => 0,
	"SI_SUBSCRIBER_DOB_3" => 0,
	"CLAIM_NUMBER" => 0,
	"PHYSICIAN_ADDRESS_1" => 0,
	"PHYSICIAN_CITY" => 0,
	"PHYSICIAN_STATE" => 0,
	"PHYSICIAN_ZIP" => 0,
	"PHYSICIAN_PHONE_1" => 0,
	"PHYSICIAN_PHONE_2" => 0,
	"PHYSICIAN_PHONE_3" => 0,
);

$error_report = "";

//Loop for validating the information- returns an error if a field is filled out, and does not match the regex, or if it is left blank and is required.
foreach ($validating_regex as $key => $regex) {
	if ((!preg_match($regex, $_POST[$key])) OR ($_POST[$key] == "" AND !array_key_exists($key, $left_blank))) {
		$error_report .= $error_dictionary[$key] . "\n";
	}
}

//displays an empty form for new visitor
if(empty($_POST)){
	$smarty->display('/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/templates/form.tpl');
}

//displays the form, filled out with user's data, with the error report at the top if errors are found.
elseif("" != $error_report){
	print($error_report);
	$smarty->assign('user_data', $_POST);
	$smarty->display('/home1/columch7/public_html/columbiaphysicaltherapyinc/form2/templates/form.tpl');
}

//If there are no errors, the user is shown a thank-you screen, and their data is imported into the database.
else{
	echo "<html><body><p>Thanks for completing this form, " . htmlspecialchars($_POST["FIRST_NAME"]) . '! <br/>Your information has been received.<br/></p></body></html>';

	//calls SQLite functionality
	$db = new SQLite3($columbiaDB);
	
	//creates function to encrypt text 
	function encrypt_text($value, $key1, $key2){ 
		if(!$value || !$key1 || !$key2) return false;
		$crypttext = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $key1, $value, MCRYPT_MODE_ECB, $key2);
		return trim(base64_encode($crypttext));
	}	
 
	//creates function to decrypt text
	function decrypt_text($value, $key1, $key2){
		if(!$value || !$key1 || !$key2) return false;
		$crypttext = base64_decode($value);
		$decrypttext = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $key1, $crypttext, MCRYPT_MODE_ECB, $key2);
		return trim($decrypttext);
	}
	
	//creates a random code for use in the insert line
	$rand_code = (rand());

	//var_dump( $_POST );
	//exit;
	
	//creates an array for the escaped values generated in the loop below
	$escaped_values = array();
	
	//loop takes the user's data and escapes any harmful characters (sterilization) and inserts them into the $escaped_values array
	foreach ($_POST as $field => $answer) {
		$escaped_values[$field] = SQLite3::escapeString($answer);
	}

	$db->exec("INSERT INTO Pasco_new_patients (
		FIRST_NAME, 
		LAST_NAME, 
		PHONE, 
		EMAIL, 
		ADDRESS, 
		CITY, 
		STATE, 
		ZIP, 
		DOB, 
		GENDER, 
		SSN, 
		SOURCE, 
		EMPLOYER, 
		EMPLOYER_ADDRESS, 
		EMPLOYER_CITY, 
		EMPLOYER_STATE, 
		EMPLOYER_ZIP, 
		REFERRING_PHYSICIAN, 
		PHYSICIAN_ADDRESS, 
		PHYSICIAN_CITY, 
		PHYSICIAN_STATE, 
		PHYSICIAN_ZIP, 
		PHYSICIAN_PHONE, 
		SPOUSE_EMPLOYER, 
		SPOUSE_HOME_PHONE, 
		SPOUSE_WORK_PHONE, 
		SPOUSE_SSN, 
		MOTHER_FIRST, 
		MOTHER_LAST, 
		MOTHER_ADDRESS, 
		MOTHER_CITY, 
		MOTHER_STATE, 
		MOTHER_ZIP, 
		MOTHER_SSN, 
		MOTHER_EMPLOYER, 
		MOTHER_EMPLOYER_ADDRESS, 
		MOTHER_EMPLOYER_CITY, 
		MOTHER_EMPLOYER_STATE, 
		MOTHER_EMPLOYER_ZIP, 
		MOTHER_EMPLOYER_PHONE, 
		FATHER_FIRST, 
		FATHER_LAST, 
		FATHER_ADDRESS, 
		FATHER_CITY, 
		FATHER_STATE, 
		FATHER_ZIP, 
		FATHER_SSN, 
		FATHER_EMPLOYER, 
		FATHER_EMPLOYER_ADDRESS, 
		FATHER_EMPLOYER_CITY, 
		FATHER_EMPLOYER_STATE, 
		FATHER_EMPLOYER_ZIP, 
		FATHER_EMPLOYER_PHONE, 
		PRIMARY_INSURANCE_NAME, 
		PRIMARY_INSURANCE_ADDRESS, 
		PRIMARY_INSURANCE_CITY, 
		PRIMARY_INSURANCE_STATE, 
		PRIMARY_INSURANCE_ZIP, 
		PI_SUBSCRIBER_FIRST, 
		PI_SUBSCRIBER_LAST, 
		PI_SUBSCRIBER_ID, 
		PI_SUBSCRIBER_GROUP_NUMBER, 
		PI_SUBSCRIBER_DOB, 
		SECONDARY_INSURANCE_NAME, 
		SECONDARY_INSURANCE_ADDRESS, 
		SECONDARY_INSURANCE_CITY, 
		SECONDARY_INSURANCE_STATE, 
		SECONDARY_INSURANCE_ZIP, 
		SI_SUBSCRIBER_FIRST, 
		SI_SUBSCRIBER_LAST, 
		SI_SUBSCRIBER_ID, 
		SI_SUBSCRIBER_GROUP_NUMBER, 
		SI_SUBSCRIBER_DOB, 
		NEED_TREATMENT_FOR, 
		DATE_OF_INJURY, 
		CLAIM_NUMBER, 
		EMERGENCY_CONTACT_FIRST, 
		EMERGENCY_CONTACT_LAST, 
		EMERGENCY_CONTACT_PHONE, 
		PI_SUBSCRIBER_EMPLOYER, 
		SI_SUBSCRIBER_EMPLOYER, 
		SPOUSE_FIRST, 
		SPOUSE_LAST) 
		VALUES ('". $escaped_values["FIRST_NAME"] ."',
		'". $escaped_values["LAST_NAME"] ."' , 
		'(". $_POST["PHONE_1"] .")". $escaped_values["PHONE_2"] ."-". $escaped_values["PHONE_3"] ."',
		'". $escaped_values["EMAIL"] ."',
		'". $escaped_values["ADDRESS_1"] ." ". $escaped_values["ADDRESS_2"] ."',
		'". $escaped_values["CITY"] ."',
		'". $escaped_values["STATE"] ."',
		'". $escaped_values["ZIP"] ."',
		'". encrypt_text($_POST["DOB_1"] ."/". $_POST["DOB_2"] ."/". $_POST["DOB_3"],$key1,$key2) ."',
		'". $_POST["GENDER"] ."','". encrypt_text($_POST["SSN"],$key1,$key2) ."',
		'". $_POST["SOURCE"] ."',
		'". $_POST["EMPLOYER"] ."',
		'". $_POST["EMPLOYER_ADDRESS_1"] ." ". $_POST["EMPLOYER_ADDRESS_2"] ."',
		'". $_POST["EMPLOYER_CITY"] ."',
		'". $_POST["EMPLOYER_STATE"] ."',
		'". $_POST["EMPLOYER_ZIP"] ."',
		'". $_POST["REFERRING_PHYSICIAN"] ."',
		'". $_POST["PHYSICIAN_ADDRESS_1"] ." ". $_POST["PHYSICIAN_ADDRESS_2"] ."',
		'". $_POST["PHYSICIAN_CITY"] ."',
		'". $_POST["PHYSICIAN_STATE"] ."'
		,'". $_POST["PHYSICIAN_ZIP"] ."',
		'(". $_POST["PHYSICIAN_PHONE_1"] .")". $_POST["PHYSICIAN_PHONE_2"] ."-". $_POST["PHYSICIAN_PHONE_3"] ."',
		'". $_POST["SPOUSE_EMPLOYER"] ."',
		'(". $_POST["SPOUSE_HOME_PHONE_1"] .")". $_POST["SPOUSE_HOME_PHONE_2"] ."-". $_POST["SPOUSE_HOME_PHONE_3"] ."',
		'(". $_POST["SPOUSE_WORK_PHONE_1"] .")". $_POST["SPOUSE_WORK_PHONE_2"] ."-". $_POST["SPOUSE_WORK_PHONE_3"] ."',
		'". encrypt_text($_POST["SPOUSE_SSN"],$key1,$key2) ."',
		'". $_POST["MOTHER_FIRST"] ."',
		'". $_POST["MOTHER_LAST"] ."',
		'". $_POST["MOTHER_ADDRESS_1"] ." ". $_POST["MOTHER_ADDRESS_2"] ."',
		'". $_POST["MOTHER_CITY"] ."',
		'". $_POST["MOTHER_STATE"] ."',
		'". $_POST["MOTHER_ZIP"] ."','". encrypt_text($_POST["MOTHER_SSN"],$key1,$key2) ."',
		'". $_POST["MOTHER_EMPLOYER"] ."',
		'". $_POST["MOTHER_EMPLOYER_ADDRESS_1"] ." ". $_POST["MOTHER_EMPLOYER_ADDRESS_2"] ."',
		'". $_POST["MOTHER_EMPLOYER_CITY"] ."',
		'". $_POST["MOTHER_EMPLOYER_STATE"] ."',
		'". $_POST["MOTHER_EMPLOYER_ZIP"] ."',
		'(". $_POST["MOTHER_EMPLOYER_PHONE_1"] .")". $_POST["MOTHER_EMPLOYER_PHONE_2"] ."-". $_POST["MOTHER_EMPLOYER_PHONE_3"] ."',
		'". $_POST["FATHER_FIRST"] ."',
		'". $_POST["FATHER_LAST"] ."',
		'". $_POST["FATHER_ADDRESS_1"] ." ". $_POST["FATHER_ADDRESS_2"] ."',
		'". $_POST["FATHER_CITY"] ."',
		'". $_POST["FATHER_STATE"] ."',
		'". $_POST["FATHER_ZIP"] ."',
		'". encrypt_text($_POST["FATHER_SSN"],$key1,$key2) ."',
		'". $_POST["FATHER_EMPLOYER"] ."',
		'". $_POST["FATHER_EMPLOYER_ADDRESS_1"] ." ". $_POST["FATHER_EMPLOYER_ADDRESS_2"] ."',
		'". $_POST["FATHER_EMPLOYER_CITY"] ."',
		'". $_POST["FATHER_EMPLOYER_STATE"] ."',
		'". $_POST["FATHER_EMPLOYER_ZIP"] ."',
		'(". $_POST["FATHER_EMPLOYER_PHONE_1"] .")". $_POST["FATHER_EMPLOYER_PHONE_2"] ."-". $_POST["FATHER_EMPLOYER_PHONE_3"] ."',
		'". $_POST["PRIMARY_INSURANCE_NAME"] ."',
		'". $_POST["PRIMARY_INSURANCE_ADDRESS_1"] ." ". $_POST["PRIMARY_INSURANCE_ADDRESS_2"] ."',
		'". $_POST["PRIMARY_INSURANCE_CITY"] ."',
		'". $_POST["PRIMARY_INSURANCE_STATE"] ."',
		'". $_POST["PRIMARY_INSURANCE_ZIP"] ."',
		'". $_POST["PI_SUBSCRIBER_FIRST"] ."',
		'". $_POST["PI_SUBSCRIBER_LAST"] ."',
		'". encrypt_text($_POST["PI_SUBSCRIBER_ID"],$key1,$key2) ."',
		'". $_POST["PI_SUBSCRIBER_GROUP_NUMBER"] ."',
		'". encrypt_text($_POST["PI_SUBSCRIBER_DOB_1"] ."/". $_POST["PI_SUBSCRIBER_DOB_2"] ."/". $_POST["PI_SUBSCRIBER_DOB_3"],$key1,$key2) ."',
		'". $_POST["SECONDARY_INSURANCE_NAME"] ."',
		'". $_POST["SECONDARY_INSURANCE_ADDRESS_1"] ." ". $_POST["SECONDARY_INSURANCE_ADDRESS_2"] ."',
		'".$_POST["SECONDARY_INSURANCE_CITY"] ."',
		'". $_POST["SECONDARY_INSURANCE_STATE"] ."',
		'". $_POST["SECONDARY_INSURANCE_ZIP"] ."',
		'". $_POST["SI_SUBSCRIBER_FIRST"] ."',
		'". $_POST["SI_SUBSCRIBER_LAST"] ."',
		'". encrypt_text($_POST["SI_SUBSCRIBER_ID"],$key1,$key2) ."',
		'". $_POST["SI_SUBSCRIBER_GROUP_NUMBER"] ."',
		'". encrypt_text($_POST["SI_SUBSCRIBER_DOB_1"] ."/". $_POST["SI_SUBSCRIBER_DOB_2"] ."/". $_POST["SI_SUBSCRIBER_DOB_3"],$key1,$key2) ."',
		'". $_POST["NEED_TREATMENT_FOR"] ."',
		'". $_POST["DATE_OF_INJURY_1"] ."/". $_POST["DATE_OF_INJURY_2"] ."/". $_POST["DATE_OF_INJURY_3"] ."',
		'". encrypt_text($_POST["CLAIM_NUMBER"],$key1,$key2) ."',
		'". $_POST["EMERGENCY_CONTACT_FIRST"] ."',
		'". $_POST["EMERGENCY_CONTACT_LAST"] ."',
		'(". $_POST["EMERGENCY_CONTACT_PHONE_1"] .")". $_POST["EMERGENCY_CONTACT_PHONE_2"] ."-". $_POST["EMERGENCY_CONTACT_PHONE_3"] ."',
		'". $_POST["PI_SUBSCRIBER_EMPLOYER"] ."',
		'". $_POST["SI_SUBSCRIBER_EMPLOYER"] ."',
		'". $_POST["SPOUSE_FIRST"] ."',
		'". $_POST["SPOUSE_LAST"] ."')"); 

echo "<br />Inserted row into table Pasco_new_patients <br />";

?>
</p>
